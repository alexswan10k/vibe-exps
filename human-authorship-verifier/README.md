# Human Authorship Verifier

A comprehensive system for cryptographically verifying human authorship of text using behavioral logging, digital signatures, and anonymous user fingerprints. This tool provides verifiable provenance that text was typed by a human, not generated by AI or copied.

## Features

- **Cryptographic Verification**: RSA-PSS signatures with SHA-256 hashing
- **Behavioral Logging**: Keystroke patterns and timing analysis
- **Anonymous User Fingerprints**: User-defined identifiers hashed for privacy
- **Key Pair Management**: Generate, export, and import cryptographic keys
- **Live HTML Generation**: Real-time output for web publishing
- **Cross-Platform**: Works in any modern web browser

## Quick Start

1. Open `index.html` in your web browser
2. Generate or import a key pair
3. (Optional) Set your user fingerprint for anonymous identification
4. Type your text - keystrokes are automatically logged
5. Copy the generated HTML output
6. Host the eventlog.txt file at a public URL
7. Update the `data-hav-log` attribute to point to your hosted log
8. Publish the HTML on your website

## Components

### Key Pair Management

- **Generate Key Pair**: Creates RSA-PSS key pair (2048-bit modulus, SHA-256 hash)
- **Export Key Pair**: Downloads complete key pair as JSON for backup
- **Import Key Pair**: Restores key pair from backup file
- **Local Storage**: Keys stored securely in browser localStorage

### User Fingerprint System

- **Anonymous Identification**: User-defined identifier (name, DOB, etc.) hashed with SHA-256
- **Cross-Key Consistency**: Same user recognized across different key pairs
- **Privacy Protection**: Personal information is cryptographically hashed
- **Optional**: Users can choose not to set a fingerprint

### Behavioral Logging

While typing, the following events are logged:
- `keydown`: Key pressed with timestamp
- `keyup`: Key released with timestamp
- `diff`: Text changes (added/removed characters) with timestamp

### Output Format

The verifiable text is embedded as an HTML element with data attributes:

```html
<p data-hav-key="publickeyjson" data-hav-log="eventlog.txt" data-hav-signature="base64signature" data-hav-fingerprint="fingerprint">The authored text here.</p>
```

- `data-hav-key`: JSON string of the author's public key (JWK format)
- `data-hav-log`: URL pointing to the JSON event log file
- `data-hav-signature`: Base64-encoded RSA-PSS signature of the log content
- `data-hav-fingerprint`: SHA-256 hash of user's anonymous identifier (optional)

### Log File Format

The log is a JSON array of events:

```json
[
  {"type": "keydown", "key": "H", "time": 1234567890123},
  {"type": "keyup", "key": "H", "time": 1234567890130},
  {"type": "diff", "change": {"added": "H", "pos": 0}, "time": 1234567890135},
  ...
]
```

## User Interface

The web application provides an intuitive interface with the following sections:

### 1. Key Management
- **Generate Key Pair**: Creates new RSA-PSS cryptographic keys
- **Export Key Pair**: Downloads complete key pair for backup
- **Import Key Pair**: Restores keys from backup file
- **Clear Stored Keys**: Removes all stored cryptographic material

### 2. User Fingerprint (Optional)
- **Input Field**: Enter personal identifier (name, DOB, nickname, etc.)
- **Update Fingerprint**: Generates SHA-256 hash for anonymous identification
- **Display**: Shows current fingerprint hash
- **Purpose**: Enables cross-key-pair user recognition while maintaining anonymity

### 3. Text Authoring
- **Live Typing**: Real-time keystroke logging
- **Event Tracking**: Captures keydown, keyup, and text diff events
- **Character Count**: Shows typing progress

### 4. Output Generation
- **Live HTML**: Real-time generated verifiable HTML
- **Copy to Clipboard**: Easy copying of output
- **Download Log**: Export event log as JSON file

## Detailed Workflow

1. **Initial Setup**:
   - Open `index.html` in a modern web browser
   - Generate a new key pair or import existing keys

2. **Optional Fingerprint Setup**:
   - Enter a personal identifier (e.g., "John Doe", "johndoe@example.com")
   - Click "Update Fingerprint" to generate anonymous hash
   - This creates a consistent identifier across different key pairs

3. **Content Creation**:
   - Type your text in the input field
   - Keystrokes are automatically logged with timestamps
   - View real-time HTML output generation

4. **Export & Hosting**:
   - Copy the generated HTML output
   - Download the eventlog.txt file
   - Host the log file at a publicly accessible URL

5. **Publishing**:
   - Embed the HTML in your webpage
   - Update `data-hav-log` to point to your hosted log URL
   - The public key and fingerprint are already embedded

6. **Verification**:
   - Others can verify your authorship using the embedded data
   - Fingerprint allows recognition across different key pairs

## Verification Process

To verify a piece of text:

1. Extract the log URL from `data-hav-log`.
2. Fetch the log file.
3. Extract the public key from `data-hav-key`.
4. Verify the signature using the author's public key.
5. Reconstruct the text from the log events.
6. Compare reconstructed text with displayed text.
7. (Optional) Extract fingerprint from `data-hav-fingerprint` for user identification.

### Fingerprint Verification

The fingerprint allows verification that multiple pieces of content were authored by the same anonymous user:

```javascript
function verifyFingerprint(content1, content2) {
  const fp1 = content1.getAttribute('data-hav-fingerprint');
  const fp2 = content2.getAttribute('data-hav-fingerprint');
  return fp1 && fp2 && fp1 === fp2;
}
```

This enables:
- **Cross-Platform Recognition**: Same user across different devices
- **Key Migration**: User consistency when changing key pairs
- **Account Continuity**: Proving authorship history anonymously

### Reconstruction Algorithm

```javascript
function reconstructText(log) {
  let text = '';
  log.forEach(entry => {
    if (entry.type === 'diff' && !entry.change.unchanged) {
      if (entry.change.added) {
        text += entry.change.added;
      } else if (entry.change.removed) {
        text = text.slice(0, entry.change.pos);
      }
    }
  });
  return text;
}
```

### Signature Verification

Use RSA-PSS verification with SHA-256 to verify the log content against the signature and public key.

## Security Considerations

### Cryptographic Security
- The private key must remain secret and never be shared
- RSA-PSS with SHA-256 provides strong cryptographic guarantees
- Key pairs are generated using Web Crypto API with secure parameters
- All signatures are cryptographically verifiable

### Fingerprint Privacy
- User identifiers are hashed with SHA-256 before storage or transmission
- Fingerprints enable anonymous user recognition without revealing personal data
- Users have full control over what information to include in their fingerprint
- Fingerprints are optional and can be omitted for maximum privacy

### Content Security
- The log file must be hosted securely to prevent tampering
- Keystroke timing patterns provide additional evidence of human authorship
- Event logs contain behavioral data that is difficult to forge artificially
- This system proves the text was typed by someone with access to the private key

### Verification Trust
- Public keys are embedded in the HTML for immediate verification
- Log files should be hosted on trusted, tamper-resistant infrastructure
- The system assumes honest log hosting for full security guarantees
- Multiple verification methods (signature + fingerprint + behavioral data) provide layered security

## Implementation

See `index.html` for a reference implementation using Web Crypto API.

## Limitations

- Requires JavaScript-enabled browser for authoring.
- Assumes honest log hosting.
- Does not prevent screen recording or other input methods.
- Verification requires access to the public key.
